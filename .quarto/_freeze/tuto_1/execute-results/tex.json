{
  "hash": "ccfd078a61bf15cbc299308a6ec0fa31",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Prédiction des fleurs d'iris avec la RL\"\nformat: pdf\nauthor: Ousmane lom\n---\n\n\n# Installation des librairies\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(prettyR)\nlibrary(tidyverse)\nlibrary(gt)\nlibrary(corrplot)\nlibrary(nnet)\n```\n:::\n\n\nDataset des Fleurs d'iris\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata=iris\n```\n:::\n\n\n# Structure des données\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t150 obs. of  5 variables:\n $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...\n $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...\n $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...\n $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...\n $ Species     : Factor w/ 3 levels \"setosa\",\"versicolor\",..: 1 1 1 1 1 1 1 1 1 1 ...\n```\n\n\n:::\n:::\n\n\n# Visualisez les 1er lignes\n\n\n::: {.cell}\n\n```{.r .cell-code}\niris %>% \n                  head(n=10) %>% \n                  gt()\n```\n\n::: {.cell-output-display}\n\\begingroup\n\\fontsize{12.0pt}{14.4pt}\\selectfont\n\\begin{longtable}{rrrrc}\n\\toprule\nSepal.Length & Sepal.Width & Petal.Length & Petal.Width & Species \\\\ \n\\midrule\\addlinespace[2.5pt]\n5.1 & 3.5 & 1.4 & 0.2 & setosa \\\\ \n4.9 & 3.0 & 1.4 & 0.2 & setosa \\\\ \n4.7 & 3.2 & 1.3 & 0.2 & setosa \\\\ \n4.6 & 3.1 & 1.5 & 0.2 & setosa \\\\ \n5.0 & 3.6 & 1.4 & 0.2 & setosa \\\\ \n5.4 & 3.9 & 1.7 & 0.4 & setosa \\\\ \n4.6 & 3.4 & 1.4 & 0.3 & setosa \\\\ \n5.0 & 3.4 & 1.5 & 0.2 & setosa \\\\ \n4.4 & 2.9 & 1.4 & 0.2 & setosa \\\\ \n4.9 & 3.1 & 1.5 & 0.1 & setosa \\\\ \n\\bottomrule\n\\end{longtable}\n\\endgroup\n\n:::\n:::\n\n\n# Analyse descriptive de l'ensemble des variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndescribe(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nDescription of data \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n Numeric \n             mean median  var   sd valid.n\nSepal.Length 5.84   5.80 0.69 0.83     150\nSepal.Width  3.06   3.00 0.19 0.44     150\nPetal.Length 3.76   4.35 3.12 1.77     150\nPetal.Width  1.20   1.30 0.58 0.76     150\n\n Factor \n         \nSpecies   setosa versicolor virginica\n  Count    50.00      50.00     50.00\n  Percent  33.33      33.33     33.33\nMode >1 mode \n```\n\n\n:::\n:::\n\n\n# Visualisez les variables\n\n### Diagramme en histogramme de la variable Petal.length\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris,aes(x=Petal.Length))+\n                  geom_histogram(color=\"blue\",fill=\"gray3\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](tuto_1_files/figure-pdf/unnamed-chunk-6-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n# Distribution de la variable Petal.length\n\n## Diagramme en boxplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris,aes(x=\"\",y=Sepal.Length))+geom_boxplot(fill=\"turquoise\",outliers = TRUE)\n```\n\n::: {.cell-output-display}\n![](tuto_1_files/figure-pdf/unnamed-chunk-7-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n# Correlation entre les variables quantitatives\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorr=round(cor(iris[,-5]),2)\ncorr\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Sepal.Length Sepal.Width Petal.Length Petal.Width\nSepal.Length         1.00       -0.12         0.87        0.82\nSepal.Width         -0.12        1.00        -0.43       -0.37\nPetal.Length         0.87       -0.43         1.00        0.96\nPetal.Width          0.82       -0.37         0.96        1.00\n```\n\n\n:::\n\n```{.r .cell-code}\ncorrplot(corr,method=\"number\")\n```\n\n::: {.cell-output-display}\n![](tuto_1_files/figure-pdf/unnamed-chunk-8-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n# Distribution du Petal length par variété (Species)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris,aes(x=Species,y=Petal.Length,fill = Species))+\ngeom_boxplot(color=\"blue\")+\n                  labs(x=\"Species\",y=\"Petal length\",title=\"Distribution des Pétales par espéce\")\n```\n\n::: {.cell-output-display}\n![](tuto_1_files/figure-pdf/unnamed-chunk-9-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n## Analyse de la variance\n\nH0: Pas de différence significative de la longueur des pétales entre variétes\n\nH1: Il ya une différence signicative entre la longueur des pétales entre variétes de fleurs\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova=aov(Petal.Length~Species,iris)\nsummary(anova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Df Sum Sq Mean Sq F value Pr(>F)    \nSpecies       2  437.1  218.55    1180 <2e-16 ***\nResiduals   147   27.2    0.19                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\\textbf{Conclusion:} Donc on note un effet siginificatif entre les variétes selon la longueur des pétales\n\n# Apprentissage automatique\n\n## Prediction des fleurs par un modéle multinomial\n\nPartitionner la base de donnée en donnée d'entrainement de notre modéle à 70% et test à 30%\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\nind<-sample(2,nrow(iris),replace = T,prob = c(0.70,0.30))\ntrain=iris[ind==1,]\ntest=iris[ind==2,]\n```\n:::\n\n\nDimension train et test data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(\"dimension_train est:\",dim(train),fill = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndimension_train est: 112 5\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"dimension_test est:\",dim(test),fill = T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndimension_test est: 38 5\n```\n\n\n:::\n:::\n\n\n## Construire le modéle\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel=multinom(Species~., data=iris)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# weights:  18 (10 variable)\ninitial  value 164.791843 \niter  10 value 16.177348\niter  20 value 7.111438\niter  30 value 6.182999\niter  40 value 5.984028\niter  50 value 5.961278\niter  60 value 5.954900\niter  70 value 5.951851\niter  80 value 5.950343\niter  90 value 5.949904\niter 100 value 5.949867\nfinal  value 5.949867 \nstopped after 100 iterations\n```\n\n\n:::\n:::\n\n\n## Resumé du modéle\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\nmultinom(formula = Species ~ ., data = iris)\n\nCoefficients:\n           (Intercept) Sepal.Length Sepal.Width Petal.Length Petal.Width\nversicolor    18.69037    -5.458424   -8.707401     14.24477   -3.097684\nvirginica    -23.83628    -7.923634  -15.370769     23.65978   15.135301\n\nStd. Errors:\n           (Intercept) Sepal.Length Sepal.Width Petal.Length Petal.Width\nversicolor    34.97116     89.89215    157.0415     60.19170    45.48852\nvirginica     35.76649     89.91153    157.1196     60.46753    45.93406\n\nResidual Deviance: 11.89973 \nAIC: 31.89973 \n```\n\n\n:::\n:::\n\n\nPrédiction du model avec les données test\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredictions=predict(model,test)\npredictions[1:10]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] setosa setosa setosa setosa setosa setosa setosa setosa setosa setosa\nLevels: setosa versicolor virginica\n```\n\n\n:::\n:::\n\n\n### Calcul de l'accuracy du modéle\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntab=table(test$Species,predictions)\ntab\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            predictions\n             setosa versicolor virginica\n  setosa         10          0         0\n  versicolor      0         12         0\n  virginica       0          0        16\n```\n\n\n:::\n:::\n\n\n## Calcul de l'accuracy\n\n$$\naccuray=\\frac{\\sum(diag(tab))}{\\sum(tab)}\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\naccuracy=sum(diag(tab))/sum(tab)\ncat(\"accuracy est\",accuracy,fill=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\naccuracy est 1\n```\n\n\n:::\n:::\n\n\nLe modéle prédit à 100% le type de fleur\n",
    "supporting": [
      "tuto_1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "\\usepackage{booktabs}\n\\usepackage{caption}\n\\usepackage{longtable}\n\\usepackage{colortbl}\n\\usepackage{array}\n\\usepackage{anyfontsize}\n\\usepackage{multirow}\n"
      ]
    },
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}